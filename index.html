<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Scissor/Paper/Rock Game</title>
</head>
<body>
    <script>
        // takes the player input. Ensures it is a valid input..
        // also changes the input to lower case
        function playerPlay() {
            let selection = prompt('Enter either scissors, paper or rock. Best out of 5');
            if (selection == null) {
                return null;
            } else if (selection == '') {
                alert('You must enter either scissors, paper or rock');
                return '';
            } else {
                selection = selection.toLowerCase();
            }
            if (selection === 'scissors' || selection === 'paper' || selection === 'rock') {
                return selection;
            } else {
                alert('You must enter either scissors, paper or rock');
                return '';
            }
        }

        // generates the computer input. 
        // generates a random whole number between 1-3 and converts that to the 3 choices
        function computerPlay(min, max) {
            let randomNumber = Math.floor(Math.random() * (max - min + 1)) + min;
            let selection;
                if (randomNumber == 1) {
                    selection = 'scissors'; 
                } else if (randomNumber == 2) {
                    selection = 'paper';
                } else if (randomNumber == 3) {
                    selection = 'rock';
                }
            return selection;
        }
        
        // this is how 1 round is played
        // compares the results of the first 2 functions and determines win, lose or draw
        // also accepts inputs of null and '' and acts acordingly
        function playRound(player, computer) {
            if ((player == 'scissors' && computer == 'rock') ||
                (player == 'paper' && computer == 'scissors') ||
                (player == 'rock' && computer == 'paper')) {
                    return `You lose! ${computer} beats ${player}`;
                } else if ((player == 'scissors' && computer == 'paper') ||
                            (player == 'paper' && computer == 'rock') ||
                            (player == 'rock' && computer == 'scissors')) {
                    return `You win! ${player} beats ${computer}`;
                } else if (player == computer) {
                    return `It's a draw! You both picked ${player}`;
                } else if (player == null) {
                    return ('Game cancelled');
                } else if (player == '');
                    return('Invalid round, try again')
        }

        // this loops the playRound function 5 times
        // it will not increase the count if the input is null, invalid
        // after 5 rounds it determines the overall winner of if it was a draw
        function game() {
            let winOrLose;
            let playerCount = 0;
            let computerCount = 0;
                for (let i = 0; i < 5; i++) {
                    let computerSelection = computerPlay(1, 3);
                    let playerSelection = playerPlay();
                    console.log(playRound(playerSelection, computerSelection));
                    winOrLose = playRound(playerSelection, computerSelection);
                        if (winOrLose.includes('cancelled')) {
                            i = 4;
                            return;
                        } else if (winOrLose.includes('win')) {
                            playerCount++;
                        } else if (winOrLose.includes('lose')) {
                            computerCount++;
                        } else if (winOrLose.includes('Invalid')) {
                            i--;
                        }
                console.log(`After Round ${i + 1}, Player ${playerCount} || Computer ${computerCount}`)   
                }
                
                if (playerCount > computerCount) {
                    console.log('You are the overall winner!');
                } else if (computerCount > playerCount) {
                    console.log('The computer is the overall winner!');
                } else {
                    console.log('It was a draw overall!');
                }
        }
        game();
    </script>
</body>
</html>